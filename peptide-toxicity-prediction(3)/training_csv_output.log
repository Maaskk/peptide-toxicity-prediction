
======================================================================
                 PEPTIDE TOXICITY PREDICTION PIPELINE                 
======================================================================

Academic-Quality Machine Learning for Bioinformatics
Predicting peptide toxicity from amino acid sequences

[16:48:15] INFO: Random seed set to 42 for reproducibility

======================================================================
                         STEP 1: DATA LOADING                         
======================================================================

Loading datasets...
Loading from CSV files...

✓ Training set: 7924 samples
  - Toxic: 3963 (50.0%)
  - Non-toxic: 3961 (50.0%)

✓ Validation set: 881 samples
  - Toxic: 441 (50.1%)
  - Non-toxic: 440 (49.9%)

✓ Test set: 2203 samples
  - Toxic: 1100 (49.9%)
  - Non-toxic: 1103 (50.1%)

Training Set Statistics:
  Total samples: 7924
  Toxic: 3963 (50.0%)
  Non-toxic: 3961 (50.0%)
  Length: 22.1 ± 7.8 AA
  Range: [5, 35] AA

Validation Set Statistics:
  Total samples: 881
  Toxic: 441 (50.1%)
  Non-toxic: 440 (49.9%)
  Length: 22.1 ± 8.2 AA
  Range: [5, 35] AA

Test Set Statistics:
  Total samples: 2203
  Toxic: 1100 (49.9%)
  Non-toxic: 1103 (50.1%)
  Length: 22.1 ± 7.9 AA
  Range: [5, 35] AA

[16:48:16] INFO: Loaded 7924 training samples

======================================================================
                      STEP 2: FEATURE EXTRACTION                      
======================================================================

Feature extraction configuration:
  Amino acid composition: 20 features
  Sequence length: 1 feature
  Physicochemical properties: 6 features
  Dipeptide composition: Not used
  Total features: 27

Extracting features for 7924 sequences...
Feature dimensionality: 27
Feature extraction complete. Shape: (7924, 27)
Extracting features for 881 sequences...
Feature dimensionality: 27
Feature extraction complete. Shape: (881, 27)
Extracting features for 2203 sequences...
Feature dimensionality: 27
Feature extraction complete. Shape: (2203, 27)
[16:48:23] INFO: Feature extraction complete: 27 features

======================================================================
                        STEP 3: MODEL TRAINING                        
======================================================================


======================================================================
TRAINING MACHINE LEARNING MODELS
======================================================================

Standardizing features...
Training set: 7924 samples
Validation set: 881 samples
Feature dimensionality: 27

======================================================================
Training: Logistic Regression
======================================================================
Hyperparameter search space: 5 combinations
Fitting 5 folds for each of 5 candidates, totalling 25 fits

✓ Best parameters: {'C': 1.0, 'penalty': 'l2', 'solver': 'lbfgs'}
✓ Cross-validation F1: 0.7942 (+/- 0.0085)
✓ Validation accuracy: 0.7877

======================================================================
Training: Random Forest
======================================================================
Hyperparameter search space: 108 combinations
Fitting 5 folds for each of 108 candidates, totalling 540 fits

✓ Best parameters: {'max_depth': 30, 'min_samples_leaf': 1, 'min_samples_split': 5, 'n_estimators': 300}
✓ Cross-validation F1: 0.8602 (+/- 0.0050)
✓ Validation accuracy: 0.8411

======================================================================
Training: SVM
======================================================================
Hyperparameter search space: 20 combinations
Fitting 5 folds for each of 20 candidates, totalling 100 fits

✓ Best parameters: {'C': 1.0, 'gamma': 0.1, 'kernel': 'rbf'}
✓ Cross-validation F1: 0.8584 (+/- 0.0066)
✓ Validation accuracy: 0.8422

======================================================================
TRAINING COMPLETE
======================================================================

[17:51:12] INFO: Model training complete
Models saved to results/trained_models.pkl
[17:51:13] INFO: Models saved

======================================================================
                       STEP 4: MODEL EVALUATION                       
======================================================================


======================================================================
Evaluating Logistic Regression
======================================================================

--- VALIDATION SET ---

======================================================================
EVALUATING: Logistic Regression
======================================================================

Classification Metrics:
  Accuracy:  0.7877
  Precision: 0.8256
  Recall:    0.7302
  F1-score:  0.7750
  ROC-AUC:   0.8515

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.7576    0.8455    0.7991       440
       Toxic     0.8256    0.7302    0.7750       441

    accuracy                         0.7877       881
   macro avg     0.7916    0.7878    0.7871       881
weighted avg     0.7917    0.7877    0.7870       881

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      372      68
       Toxic          119     322

--- TEST SET (INDEPENDENT) ---

======================================================================
EVALUATING: Logistic Regression
======================================================================

Classification Metrics:
  Accuracy:  0.8175
  Precision: 0.8504
  Recall:    0.7700
  F1-score:  0.8082
  ROC-AUC:   0.8869

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.7904    0.8649    0.8260      1103
       Toxic     0.8504    0.7700    0.8082      1100

    accuracy                         0.8175      2203
   macro avg     0.8204    0.8175    0.8171      2203
weighted avg     0.8204    0.8175    0.8171      2203

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      954     149
       Toxic          253     847
✓ Confusion matrix saved to results/Logistic_Regression_confusion_matrix.png
✓ ROC curve saved to results/Logistic_Regression_roc_curve.png
✓ Feature importance plot saved to results/Logistic_Regression_feature_importance.png

Top 10 Most Important Features:
   1. AAC_C                          1.595550
   2. molecular_weight               0.696225
   3. length                         0.529943
   4. AAC_V                          0.484713
   5. AAC_T                          0.428516
   6. isoelectric_point              0.342058
   7. gravy                          0.337474
   8. AAC_S                          0.333156
   9. AAC_A                          0.327123
  10. AAC_M                          0.326337

======================================================================
Evaluating Random Forest
======================================================================

--- VALIDATION SET ---

======================================================================
EVALUATING: Random Forest
======================================================================

Classification Metrics:
  Accuracy:  0.8411
  Precision: 0.8698
  Recall:    0.8027
  F1-score:  0.8349
  ROC-AUC:   0.9155

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.8165    0.8795    0.8468       440
       Toxic     0.8698    0.8027    0.8349       441

    accuracy                         0.8411       881
   macro avg     0.8431    0.8411    0.8409       881
weighted avg     0.8431    0.8411    0.8409       881

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      387      53
       Toxic           87     354

--- TEST SET (INDEPENDENT) ---

======================================================================
EVALUATING: Random Forest
======================================================================

Classification Metrics:
  Accuracy:  0.8842
  Precision: 0.9043
  Recall:    0.8591
  F1-score:  0.8811
  ROC-AUC:   0.9453

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.8661    0.9093    0.8872      1103
       Toxic     0.9043    0.8591    0.8811      1100

    accuracy                         0.8842      2203
   macro avg     0.8852    0.8842    0.8842      2203
weighted avg     0.8852    0.8842    0.8842      2203

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic     1003     100
       Toxic          155     945
✓ Confusion matrix saved to results/Random_Forest_confusion_matrix.png
✓ ROC curve saved to results/Random_Forest_roc_curve.png
✓ Feature importance plot saved to results/Random_Forest_feature_importance.png

Top 10 Most Important Features:
   1. AAC_C                          0.293674
   2. net_charge_pH7                 0.048733
   3. AAC_L                          0.044682
   4. gravy                          0.044616
   5. isoelectric_point              0.039712
   6. AAC_V                          0.038259
   7. AAC_K                          0.036859
   8. instability_index              0.036545
   9. molecular_weight               0.031721
  10. AAC_A                          0.029746

======================================================================
Evaluating SVM
======================================================================

--- VALIDATION SET ---

======================================================================
EVALUATING: SVM
======================================================================

Classification Metrics:
  Accuracy:  0.8422
  Precision: 0.8738
  Recall:    0.8005
  F1-score:  0.8355
  ROC-AUC:   0.9034

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.8155    0.8841    0.8484       440
       Toxic     0.8738    0.8005    0.8355       441

    accuracy                         0.8422       881
   macro avg     0.8446    0.8423    0.8420       881
weighted avg     0.8447    0.8422    0.8420       881

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      389      51
       Toxic           88     353

--- TEST SET (INDEPENDENT) ---

======================================================================
EVALUATING: SVM
======================================================================

Classification Metrics:
  Accuracy:  0.8729
  Precision: 0.8965
  Recall:    0.8427
  F1-score:  0.8688
  ROC-AUC:   0.9372

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.8520    0.9030    0.8768      1103
       Toxic     0.8965    0.8427    0.8688      1100

    accuracy                         0.8729      2203
   macro avg     0.8743    0.8729    0.8728      2203
weighted avg     0.8742    0.8729    0.8728      2203

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      996     107
       Toxic          173     927
✓ Confusion matrix saved to results/SVM_confusion_matrix.png
✓ ROC curve saved to results/SVM_roc_curve.png
Feature importance not available for SVM
✓ Model comparison saved to results/model_comparison_f1_score.png
✓ Model comparison saved to results/model_comparison_roc_auc.png
[17:51:33] INFO: Model evaluation complete

======================================================================
                  STEP 5: BIOLOGICAL INTERPRETATION                   
======================================================================


======================================================================
BIOLOGICAL ANALYSIS: Amino Acid Distribution
======================================================================

Toxic peptides: 1100
Non-toxic peptides: 1103

Amino Acid Enrichment Analysis:
AA    Toxic %      Non-toxic %     Difference   p-value    Significance
----------------------------------------------------------------------
A           6.14%          8.29%      -2.15%     0.0000   ***
C          15.44%          1.86%      13.59%     0.0000   ***
D           3.66%          4.67%      -1.01%     0.0000   ***
E           3.56%          5.16%      -1.60%     0.0000   ***
F           3.79%          4.61%      -0.82%     0.0003   ***
G           8.42%          8.45%      -0.03%     0.9152   
H           2.46%          1.94%       0.52%     0.0022   **
I           4.88%          6.42%      -1.54%     0.0000   ***
K           6.28%          6.09%       0.19%     0.5092   
L           6.85%          9.90%      -3.04%     0.0000   ***
M           1.41%          2.63%      -1.22%     0.0000   ***
N           4.29%          3.86%       0.43%     0.0434   *
P           6.97%          5.00%       1.97%     0.0000   ***
Q           2.30%          3.16%      -0.86%     0.0000   ***
R           4.85%          5.13%      -0.28%     0.3378   
S           5.98%          6.47%      -0.49%     0.0444   *
T           3.55%          5.29%      -1.74%     0.0000   ***
V           4.45%          6.96%      -2.50%     0.0000   ***
W           1.99%          1.12%       0.86%     0.0000   ***
Y           2.73%          2.99%      -0.27%     0.1360   

* p < 0.05, ** p < 0.01, *** p < 0.001

Biological Interpretation:
----------------------------------------------------------------------
  • C (polar): enriched in toxic peptides
    Difference: 13.59%, p=0.000000

  • L (hydrophobic): depleted in toxic peptides
    Difference: 3.04%, p=0.000000

  • V (hydrophobic): depleted in toxic peptides
    Difference: 2.50%, p=0.000000

  • A (hydrophobic, small): depleted in toxic peptides
    Difference: 2.15%, p=0.000000

  • P (hydrophobic): enriched in toxic peptides
    Difference: 1.97%, p=0.000000

  • T (hydrophilic, small): depleted in toxic peptides
    Difference: 1.74%, p=0.000000

  • E (negative): depleted in toxic peptides
    Difference: 1.60%, p=0.000000

  • I (hydrophobic): depleted in toxic peptides
    Difference: 1.54%, p=0.000000

  • M (hydrophobic): depleted in toxic peptides
    Difference: 1.22%, p=0.000000

  • D (negative): depleted in toxic peptides
    Difference: 1.01%, p=0.000004

  • Q (hydrophilic): depleted in toxic peptides
    Difference: 0.86%, p=0.000000

  • W (hydrophobic, aromatic): enriched in toxic peptides
    Difference: 0.86%, p=0.000000
    → Aromatic residues enhance membrane insertion

  • F (hydrophobic, aromatic): depleted in toxic peptides
    Difference: 0.82%, p=0.000281

  • H (positive): enriched in toxic peptides
    Difference: 0.52%, p=0.002185

  • S (hydrophilic, small): depleted in toxic peptides
    Difference: 0.49%, p=0.044422

  • N (hydrophilic): enriched in toxic peptides
    Difference: 0.43%, p=0.043400

✓ Amino acid composition comparison saved to results/aa_composition_comparison.png

======================================================================
BIOLOGICAL ANALYSIS: Physicochemical Properties
======================================================================

Length:
  Toxic:     mean=21.817, std=8.030
  Non-toxic: mean=22.399, std=7.819
  p-value: 0.085270 

Molecular Weight:
  Toxic:     mean=2399.644, std=876.917
  Non-toxic: mean=2485.198, std=888.976
  p-value: 0.023131 *

Net Charge Ph7:
  Toxic:     mean=0.555, std=2.739
  Non-toxic: mean=0.112, std=2.958
  p-value: 0.000274 ***

Isoelectric Point:
  Toxic:     mean=7.325, std=2.282
  Non-toxic: mean=7.111, std=2.447
  p-value: 0.034062 *

Aromaticity:
  Toxic:     mean=0.085, std=0.075
  Non-toxic: mean=0.087, std=0.071
  p-value: 0.482420 

Instability Index:
  Toxic:     mean=45.599, std=35.899
  Non-toxic: mean=35.503, std=34.438
  p-value: 0.000000 ***

Gravy:
  Toxic:     mean=0.000, std=0.780
  Non-toxic: mean=-0.040, std=0.937
  p-value: 0.268453 

✓ Physicochemical property distributions saved to results/physicochemical_distributions.png

======================================================================
BIOLOGICAL ANALYSIS: Sequence Length
======================================================================

Toxic peptides:
  Mean length: 21.82 ± 8.03 AA
  Range: 5 - 35 AA

Non-toxic peptides:
  Mean length: 22.40 ± 7.82 AA
  Range: 5 - 35 AA

Statistical difference: p = 0.085270
✓ Length distribution saved to results/length_distribution.png
[17:51:46] INFO: Biological analysis complete

======================================================================
                        STEP 6: SAVING RESULTS                        
======================================================================

✓ Results saved to results/evaluation_results.json

======================================================================
PIPELINE COMPLETE
======================================================================

Final Test Set Performance Summary:
Model                     Accuracy     F1-Score     ROC-AUC     
----------------------------------------------------------------------
Logistic Regression       0.8175       0.8082       0.8869      
Random Forest             0.8842       0.8811       0.9453      
SVM                       0.8729       0.8688       0.9372      

✓ All results saved to: results/
✓ Visualizations: results/*.png
✓ Metrics: results/evaluation_results.json
✓ Trained models: results/trained_models.pkl
✓ Log file: results/pipeline.log
[17:51:46] INFO: Pipeline execution completed successfully
