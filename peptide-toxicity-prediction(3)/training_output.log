
======================================================================
                 PEPTIDE TOXICITY PREDICTION PIPELINE                 
======================================================================

Academic-Quality Machine Learning for Bioinformatics
Predicting peptide toxicity from amino acid sequences

[23:55:16] INFO: Random seed set to 42 for reproducibility

======================================================================
                         STEP 1: DATA LOADING                         
======================================================================

Loading datasets from FASTA files...
Loading from generated dataset files...

✓ Training set: 7000 samples
  - Toxic: 3500 (50.0%)
  - Non-toxic: 3500 (50.0%)

✓ Validation set: 1500 samples
  - Toxic: 750 (50.0%)
  - Non-toxic: 750 (50.0%)

✓ Test set: 1500 samples
  - Toxic: 750 (50.0%)
  - Non-toxic: 750 (50.0%)

Training Set Statistics:
  Total samples: 7000
  Toxic: 3500 (50.0%)
  Non-toxic: 3500 (50.0%)
  Length: 52.6 ± 28.8 AA
  Range: [5, 100] AA

Validation Set Statistics:
  Total samples: 1500
  Toxic: 750 (50.0%)
  Non-toxic: 750 (50.0%)
  Length: 52.9 ± 28.9 AA
  Range: [8, 100] AA

Test Set Statistics:
  Total samples: 1500
  Toxic: 750 (50.0%)
  Non-toxic: 750 (50.0%)
  Length: 52.3 ± 29.2 AA
  Range: [9, 100] AA

[23:55:18] INFO: Loaded 7000 training samples

======================================================================
                      STEP 2: FEATURE EXTRACTION                      
======================================================================

Feature extraction configuration:
  Amino acid composition: 20 features
  Sequence length: 1 feature
  Physicochemical properties: 6 features
  Dipeptide composition: Not used
  Total features: 27

Extracting features for 7000 sequences...
Feature dimensionality: 27
Feature extraction complete. Shape: (7000, 27)
Extracting features for 1500 sequences...
Feature dimensionality: 27
Feature extraction complete. Shape: (1500, 27)
Extracting features for 1500 sequences...
Feature dimensionality: 27
Feature extraction complete. Shape: (1500, 27)
[23:55:37] INFO: Feature extraction complete: 27 features

======================================================================
                        STEP 3: MODEL TRAINING                        
======================================================================


======================================================================
TRAINING MACHINE LEARNING MODELS
======================================================================

Standardizing features...
Training set: 7000 samples
Validation set: 1500 samples
Feature dimensionality: 27

======================================================================
Training: Logistic Regression
======================================================================
Hyperparameter search space: 5 combinations
Fitting 5 folds for each of 5 candidates, totalling 25 fits

✓ Best parameters: {'C': 1.0, 'penalty': 'l2', 'solver': 'lbfgs'}
✓ Cross-validation F1: 0.7945 (+/- 0.0102)
✓ Validation accuracy: 0.7727

======================================================================
Training: Random Forest
======================================================================
Hyperparameter search space: 108 combinations
Fitting 5 folds for each of 108 candidates, totalling 540 fits

✓ Best parameters: {'max_depth': 30, 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 300}
✓ Cross-validation F1: 0.9022 (+/- 0.0115)
✓ Validation accuracy: 0.8887

======================================================================
Training: SVM
======================================================================
Hyperparameter search space: 20 combinations
Fitting 5 folds for each of 20 candidates, totalling 100 fits

✓ Best parameters: {'C': 10.0, 'gamma': 0.1, 'kernel': 'rbf'}
✓ Cross-validation F1: 0.9062 (+/- 0.0053)
✓ Validation accuracy: 0.9033

======================================================================
TRAINING COMPLETE
======================================================================

[01:12:17] INFO: Model training complete
Models saved to results/trained_models.pkl
[01:12:17] INFO: Models saved

======================================================================
                       STEP 4: MODEL EVALUATION                       
======================================================================


======================================================================
Evaluating Logistic Regression
======================================================================

--- VALIDATION SET ---

======================================================================
EVALUATING: Logistic Regression
======================================================================

Classification Metrics:
  Accuracy:  0.7727
  Precision: 0.7760
  Recall:    0.7667
  F1-score:  0.7713
  ROC-AUC:   0.8633

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.7694    0.7787    0.7740       750
       Toxic     0.7760    0.7667    0.7713       750

    accuracy                         0.7727      1500
   macro avg     0.7727    0.7727    0.7727      1500
weighted avg     0.7727    0.7727    0.7727      1500

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      584     166
       Toxic          175     575

--- TEST SET (INDEPENDENT) ---

======================================================================
EVALUATING: Logistic Regression
======================================================================

Classification Metrics:
  Accuracy:  0.7993
  Precision: 0.8131
  Recall:    0.7773
  F1-score:  0.7948
  ROC-AUC:   0.8909

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.7867    0.8213    0.8037       750
       Toxic     0.8131    0.7773    0.7948       750

    accuracy                         0.7993      1500
   macro avg     0.7999    0.7993    0.7992      1500
weighted avg     0.7999    0.7993    0.7992      1500

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      616     134
       Toxic          167     583
✓ Confusion matrix saved to results/Logistic_Regression_confusion_matrix.png
✓ ROC curve saved to results/Logistic_Regression_roc_curve.png
✓ Feature importance plot saved to results/Logistic_Regression_feature_importance.png

Top 10 Most Important Features:
   1. AAC_K                          1.692935
   2. net_charge_pH7                 1.572675
   3. AAC_G                          1.511804
   4. molecular_weight               1.410072
   5. AAC_E                          1.080007
   6. length                         0.884417
   7. AAC_R                          0.773237
   8. AAC_Q                          0.733808
   9. gravy                          0.630626
  10. isoelectric_point              0.493798

======================================================================
Evaluating Random Forest
======================================================================

--- VALIDATION SET ---

======================================================================
EVALUATING: Random Forest
======================================================================

Classification Metrics:
  Accuracy:  0.8887
  Precision: 0.8977
  Recall:    0.8773
  F1-score:  0.8874
  ROC-AUC:   0.9668

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.8801    0.9000    0.8899       750
       Toxic     0.8977    0.8773    0.8874       750

    accuracy                         0.8887      1500
   macro avg     0.8889    0.8887    0.8887      1500
weighted avg     0.8889    0.8887    0.8887      1500

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      675      75
       Toxic           92     658

--- TEST SET (INDEPENDENT) ---

======================================================================
EVALUATING: Random Forest
======================================================================

Classification Metrics:
  Accuracy:  0.9167
  Precision: 0.9287
  Recall:    0.9027
  F1-score:  0.9155
  ROC-AUC:   0.9778

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.9053    0.9307    0.9178       750
       Toxic     0.9287    0.9027    0.9155       750

    accuracy                         0.9167      1500
   macro avg     0.9170    0.9167    0.9167      1500
weighted avg     0.9170    0.9167    0.9167      1500

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      698      52
       Toxic           73     677
✓ Confusion matrix saved to results/Random_Forest_confusion_matrix.png
✓ ROC curve saved to results/Random_Forest_roc_curve.png
✓ Feature importance plot saved to results/Random_Forest_feature_importance.png

Top 10 Most Important Features:
   1. AAC_G                          0.113849
   2. AAC_K                          0.068834
   3. molecular_weight               0.063969
   4. isoelectric_point              0.058394
   5. AAC_D                          0.057058
   6. AAC_C                          0.052561
   7. AAC_P                          0.049317
   8. length                         0.047678
   9. AAC_F                          0.039926
  10. AAC_Q                          0.035889

======================================================================
Evaluating SVM
======================================================================

--- VALIDATION SET ---

======================================================================
EVALUATING: SVM
======================================================================

Classification Metrics:
  Accuracy:  0.9033
  Precision: 0.8934
  Recall:    0.9160
  F1-score:  0.9045
  ROC-AUC:   0.9621

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.9138    0.8907    0.9021       750
       Toxic     0.8934    0.9160    0.9045       750

    accuracy                         0.9033      1500
   macro avg     0.9036    0.9033    0.9033      1500
weighted avg     0.9036    0.9033    0.9033      1500

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      668      82
       Toxic           63     687

--- TEST SET (INDEPENDENT) ---

======================================================================
EVALUATING: SVM
======================================================================

Classification Metrics:
  Accuracy:  0.9113
  Precision: 0.9097
  Recall:    0.9133
  F1-score:  0.9115
  ROC-AUC:   0.9692

Detailed Classification Report:
              precision    recall  f1-score   support

   Non-toxic     0.9130    0.9093    0.9112       750
       Toxic     0.9097    0.9133    0.9115       750

    accuracy                         0.9113      1500
   macro avg     0.9113    0.9113    0.9113      1500
weighted avg     0.9113    0.9113    0.9113      1500

Confusion Matrix:
                 Predicted
                 Non-toxic  Toxic
Actual Non-toxic      682      68
       Toxic           65     685
✓ Confusion matrix saved to results/SVM_confusion_matrix.png
✓ ROC curve saved to results/SVM_roc_curve.png
Feature importance not available for SVM
✓ Model comparison saved to results/model_comparison_f1_score.png
✓ Model comparison saved to results/model_comparison_roc_auc.png
[01:12:33] INFO: Model evaluation complete

======================================================================
                  STEP 5: BIOLOGICAL INTERPRETATION                   
======================================================================


======================================================================
BIOLOGICAL ANALYSIS: Amino Acid Distribution
======================================================================

Toxic peptides: 750
Non-toxic peptides: 750

Amino Acid Enrichment Analysis:
AA    Toxic %      Non-toxic %     Difference   p-value    Significance
----------------------------------------------------------------------
A           6.78%          6.26%       0.52%     0.0701   
C           5.53%          5.51%       0.02%     0.9407   
D           3.62%          2.94%       0.68%     0.0001   ***
E           2.45%          3.85%      -1.40%     0.0000   ***
F           5.71%          4.11%       1.60%     0.0000   ***
G           5.54%         14.19%      -8.65%     0.0000   ***
H           1.29%          1.66%      -0.37%     0.0011   **
I           5.65%          3.80%       1.85%     0.0000   ***
K          14.11%          5.06%       9.04%     0.0000   ***
L          12.46%          8.08%       4.38%     0.0000   ***
M           1.80%          2.14%      -0.34%     0.0017   **
N           2.82%          3.45%      -0.63%     0.0001   ***
P           4.21%         10.98%      -6.77%     0.0000   ***
Q           2.26%          5.20%      -2.94%     0.0000   ***
R           6.89%          4.51%       2.38%     0.0000   ***
S           4.61%          6.56%      -1.95%     0.0000   ***
T           3.34%          3.70%      -0.36%     0.0465   *
V           5.76%          4.99%       0.77%     0.0017   **
W           3.41%          0.81%       2.60%     0.0000   ***
Y           1.76%          2.20%      -0.43%     0.0026   **

* p < 0.05, ** p < 0.01, *** p < 0.001

Biological Interpretation:
----------------------------------------------------------------------
  • K (positive): enriched in toxic peptides
    Difference: 9.04%, p=0.000000
    → Positive charge may facilitate membrane interaction

  • G (small): depleted in toxic peptides
    Difference: 8.65%, p=0.000000

  • P (hydrophobic): depleted in toxic peptides
    Difference: 6.77%, p=0.000000

  • L (hydrophobic): enriched in toxic peptides
    Difference: 4.38%, p=0.000000
    → Hydrophobic residues promote membrane partitioning

  • Q (hydrophilic): depleted in toxic peptides
    Difference: 2.94%, p=0.000000

  • W (hydrophobic, aromatic): enriched in toxic peptides
    Difference: 2.60%, p=0.000000
    → Aromatic residues enhance membrane insertion

  • R (positive): enriched in toxic peptides
    Difference: 2.38%, p=0.000000
    → Positive charge may facilitate membrane interaction

  • S (hydrophilic, small): depleted in toxic peptides
    Difference: 1.95%, p=0.000000

  • I (hydrophobic): enriched in toxic peptides
    Difference: 1.85%, p=0.000000
    → Hydrophobic residues promote membrane partitioning

  • F (hydrophobic, aromatic): enriched in toxic peptides
    Difference: 1.60%, p=0.000000
    → Aromatic residues enhance membrane insertion

  • E (negative): depleted in toxic peptides
    Difference: 1.40%, p=0.000000

  • V (hydrophobic): enriched in toxic peptides
    Difference: 0.77%, p=0.001728
    → Hydrophobic residues promote membrane partitioning

  • D (negative): enriched in toxic peptides
    Difference: 0.68%, p=0.000076
    → Negative charge can disrupt ionic homeostasis

  • N (hydrophilic): depleted in toxic peptides
    Difference: 0.63%, p=0.000089

  • Y (aromatic): depleted in toxic peptides
    Difference: 0.43%, p=0.002571

  • H (positive): depleted in toxic peptides
    Difference: 0.37%, p=0.001119

  • T (hydrophilic, small): depleted in toxic peptides
    Difference: 0.36%, p=0.046536

  • M (hydrophobic): depleted in toxic peptides
    Difference: 0.34%, p=0.001681

✓ Amino acid composition comparison saved to results/aa_composition_comparison.png

======================================================================
BIOLOGICAL ANALYSIS: Physicochemical Properties
======================================================================

Length:
  Toxic:     mean=47.220, std=27.869
  Non-toxic: mean=57.287, std=29.584
  p-value: 0.000000 ***

Molecular Weight:
  Toxic:     mean=5330.355, std=3047.068
  Non-toxic: mean=6299.107, std=3411.339
  p-value: 0.000000 ***

Net Charge Ph7:
  Toxic:     mean=2.879, std=3.511
  Non-toxic: mean=1.742, std=3.773
  p-value: 0.000000 ***

Isoelectric Point:
  Toxic:     mean=8.927, std=2.229
  Non-toxic: mean=7.516, std=1.961
  p-value: 0.000000 ***

Aromaticity:
  Toxic:     mean=0.109, std=0.079
  Non-toxic: mean=0.071, std=0.047
  p-value: 0.000000 ***

Instability Index:
  Toxic:     mean=37.734, std=33.916
  Non-toxic: mean=46.157, std=23.220
  p-value: 0.000000 ***

Gravy:
  Toxic:     mean=-0.071, std=0.607
  Non-toxic: mean=-0.247, std=0.610
  p-value: 0.000000 ***

✓ Physicochemical property distributions saved to results/physicochemical_distributions.png

======================================================================
BIOLOGICAL ANALYSIS: Sequence Length
======================================================================

Toxic peptides:
  Mean length: 47.22 ± 27.87 AA
  Range: 9 - 100 AA

Non-toxic peptides:
  Mean length: 57.29 ± 29.58 AA
  Range: 9 - 100 AA

Statistical difference: p = 0.000000
✓ Length distribution saved to results/length_distribution.png
[01:12:44] INFO: Biological analysis complete

======================================================================
                        STEP 6: SAVING RESULTS                        
======================================================================

✓ Results saved to results/evaluation_results.json

======================================================================
PIPELINE COMPLETE
======================================================================

Final Test Set Performance Summary:
Model                     Accuracy     F1-Score     ROC-AUC     
----------------------------------------------------------------------
Logistic Regression       0.7993       0.7948       0.8909      
Random Forest             0.9167       0.9155       0.9778      
SVM                       0.9113       0.9115       0.9692      

✓ All results saved to: results/
✓ Visualizations: results/*.png
✓ Metrics: results/evaluation_results.json
✓ Trained models: results/trained_models.pkl
✓ Log file: results/pipeline.log
[01:12:44] INFO: Pipeline execution completed successfully
